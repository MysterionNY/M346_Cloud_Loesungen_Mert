# KN08 FaaS und Backup

## Lernziel
In dieser Kompetenz wurde eine serverlose Backup- und Aufräumlösung mit **AWS Lambda (FaaS)** umgesetzt.  
Ziel war es, EC2-Instanzen automatisch zu sichern und alte Snapshots regelmäßig zu löschen – vollständig ohne eigene Server.

---

## Backup-Skript

### Erklärung
Das Backup-Skript (Python mit boto3) sucht alle EC2-Instanzen mit dem Tag **Backup=true**  
und erstellt EBS-Snapshots dieser Instanzen.  
Jeder Snapshot erhält zusätzlich den Tag **DeleteOn**, der ein Löschdatum (z. B. +7 Tage) festlegt.

### Tags der Instanzen
![Backup Tag 1][backup_1_tag]  
![Backup Tag 2][backup_2_tag]

### Erstellte Snapshots
Nach Ausführung der Lambda-Funktion „KN08-Backup“ wurden automatisch Snapshots für beide Instanzen erzeugt.

![Backup Snapshot][backup_snapshot]

---

## Cleanup-Skript

### Erklärung
Das Cleanup-Skript löscht automatisch alle Snapshots, deren Tag **DeleteOn** das aktuelle Datum erreicht hat.  
Dadurch werden alte Backups entfernt und unnötige Speicher- und Kostenbelastungen verhindert.

### Snapshot-Löschung
![Snapshot Cleanup][snapshot_cleanup]

### Vergleich vorher / nachher
Vor dem Cleanup:  
![Snapshot Liste vorher][snapshot_liste]  

Nach dem Cleanup:  
![Snapshot Liste nachher][snapshot_list_after_cleanup]

---

## Zeitplan (CRON-Job)

### Erklärung
Die Lambda-Funktionen werden mit **AWS EventBridge Scheduler** automatisch ausgeführt.  
Beispielsweise:
- Backup täglich um 02:00 Uhr  
- Cleanup täglich um 03:00 Uhr

### Cron-Ausdruck Beispiel
```bash
cron(0 2 * * ? *)   # Backup um 02:00 Uhr
cron(0 3 * * ? *)   # Cleanup um 03:00 Uhr
```

![Zeitplan mit Cron][cron_zeitplan]

[backup_1_tag]: /Images/KN08_Backup_1_Tag.png  
[backup_2_tag]: /Images/KN08_Backup_2_Tag.png  
[backup_snapshot]: /Images/KN08_Backup_Snapshot.png  
[snapshot_cleanup]: /Images/KN08_Snapshot_Cleanup.png  
[snapshot_liste]: /Images/KN08_Snapshot_Liste.png  
[snapshot_list_after_cleanup]: /Images/KN08_Snapshot_List_After_Cleanup.png  
[cron_zeitplan]: /Images/KN08_Zeitplan.png